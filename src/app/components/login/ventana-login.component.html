<div class="toda-la-pagina">
    
    <a routerLink="/" class="btn-volver-home">
        <i class="fas fa-arrow-left"></i> Volver al Inicio
    </a>

    <div class="login-card">
        
        <div class="card-header">
            <div class="icon-circle">
                <i class="fas" [ngClass]="vistaRecuperar ? 'fa-key' : 'fa-user'"></i>
            </div>
            
            <h2 *ngIf="!vistaRecuperar">Bienvenido</h2>
            <h2 *ngIf="vistaRecuperar">Recuperar Clave</h2>
            
            <p *ngIf="!vistaRecuperar">Ingresa tus credenciales para continuar</p>
            <p *ngIf="vistaRecuperar">Ingresa tu email para restablecerla</p>
        </div>
        
        <form *ngIf="!vistaRecuperar" (ngSubmit)="login()" #personaForm="ngForm">
            
            <div class="form-group">
                <label for="email">Correo Electrónico</label>
                <div class="input-wrapper">
                    <i class="fas fa-envelope input-icon"></i>
                    <input type="email" class="form-control" placeholder="ejemplo@email.com"
                        [(ngModel)]="persona.email" name="email" required>
                </div>
            </div>

            <div class="form-group">
                <label for="password">Contraseña</label>
                <div class="input-wrapper">
                    <i class="fas fa-lock input-icon"></i>
                    <input [type]="mostrarPassword ? 'text' : 'password'" class="form-control" placeholder="••••••••"
                        [(ngModel)]="persona.password" name="password" required>
                    <button type="button" class="btn-toggle-pass" (click)="togglePassword()">
                        <i class="fas" [ngClass]="mostrarPassword ? 'fa-eye-slash' : 'fa-eye'"></i>
                    </button>
                </div>
                <div class="forgot-pass-wrapper">
                    <a (click)="cambiarVista()" class="link-forgot">¿Olvidaste tu contraseña?</a>
                </div>
            </div>

            <button type="submit" class="btn btn-primary" [disabled]="cargando || personaForm.invalid">
                <span *ngIf="!cargando">Iniciar Sesión <i class="fas fa-arrow-right ms-2"></i></span>
                <span *ngIf="cargando"><i class="fas fa-spinner fa-spin"></i> Verificando...</span>
            </button>

        </form>

        <form *ngIf="vistaRecuperar" (ngSubmit)="enviarRecuperacion()">
            
            <div class="form-group">
                <label>Correo Electrónico</label>
                <div class="input-wrapper">
                    <i class="fas fa-envelope input-icon"></i>
                    <input type="email" class="form-control" placeholder="Tu email de registro"
                        [(ngModel)]="emailRecuperacion" name="emailRecu" required>
                </div>
            </div>

            <div class="feedback-msg error" *ngIf="mensajeErrorRecu">
                {{ mensajeErrorRecu }}
            </div>

            <button type="submit" class="btn btn-primary" [disabled]="cargando || !emailRecuperacion">
                <span *ngIf="!cargando">Enviar Link <i class="fas fa-paper-plane ms-2"></i></span>
                <span *ngIf="cargando"><i class="fas fa-spinner fa-spin"></i> Enviando...</span>
            </button>
            
            </form>

        <div class="feedback-msg error" *ngIf="submitted && !loginConfirmado && !vistaRecuperar">
            <i class="fas fa-exclamation-circle"></i> Email o contraseña incorrectos.
        </div>

        <div class="feedback-msg success" *ngIf="mailEnviado">
            <i class="fas fa-check-circle"></i> Revisá tu correo (y la consola del back).
        </div>

        <div class="register-section" *ngIf="!vistaRecuperar">
            <p class="register-text">¿No tienes una cuenta aún?</p>
            <a routerLink="/registro" class="link-registro">Crear cuenta nueva</a>
        </div>

    </div>
</div>